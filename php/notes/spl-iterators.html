<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Standard PHP Library &mdash; PHP SPL Iterators 1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PHP SPL Iterators 1 documentation" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">PHP SPL Iterators 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Standard PHP Library</a><ul>
<li><a class="reference internal" href="#iterators">Iterators</a><ul>
<li><a class="reference internal" href="#iterator-interface">Iterator interface</a></li>
<li><a class="reference internal" href="#iterator-apply-it-callback-array-it">iterator_apply( $it, &#8216;callback&#8217;, array($it) )</a></li>
<li><a class="reference internal" href="#iteratoraggregate-interface">IteratorAggregate interface</a></li>
<li><a class="reference internal" href="#generator-functions">Generator functions</a></li>
<li><a class="reference internal" href="#seekableiterator-interface">SeekableIterator interface</a></li>
<li><a class="reference internal" href="#arrayaccess-interface">ArrayAccess interface</a></li>
<li><a class="reference internal" href="#countable-interface">Countable interface</a></li>
<li><a class="reference internal" href="#arrayobject-class">ArrayObject class</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arrayiterator-class">ArrayIterator class</a></li>
<li><a class="reference internal" href="#iterating-recursive-structures">Iterating Recursive Structures</a><ul>
<li><a class="reference internal" href="#recursiveiterator">RecursiveIterator</a></li>
<li><a class="reference internal" href="#recursiveiteratoriterator">RecursiveIteratorIterator</a></li>
<li><a class="reference internal" href="#recursivearrayiterator">RecursiveArrayIterator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/notes/spl-iterators.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="standard-php-library">
<h1>Standard PHP Library<a class="headerlink" href="#standard-php-library" title="Permalink to this headline">¶</a></h1>
<div class="section" id="iterators">
<h2>Iterators<a class="headerlink" href="#iterators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="iterator-interface">
<h3>Iterator interface<a class="headerlink" href="#iterator-interface" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Iterator</span></code> interface allows an object to be used in <code class="docutils literal"><span class="pre">foreach</span></code> loops.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">interface</span> <span class="nc">Iterator</span> <span class="o">{</span> <span class="c1">// conceptual definitions</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="n">mixed</span> <span class="nf">current</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="n">scalar</span> <span class="nf">key</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="kt">void</span> <span class="nf">next</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="kt">void</span> <span class="nf">rewind</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="kt">boolean</span> <span class="nf">valid</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MyContainer</span> <span class="kd">implements</span> <span class="n">Iterator</span> <span class="o">{</span>
   <span class="c1">//...snip</span>
<span class="o">}</span>

 <span class="n">$x</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyClass</span><span class="o">();</span> <span class="c1">// implements Iterator</span>
 <span class="c1">//...add some elements</span>
 <span class="c1">// iterate using ``foreach``</span>
 <span class="n">foreach</span><span class="o">(</span><span class="n">$x</span> <span class="n">as</span> <span class="n">$element</span><span class="o">)</span> <span class="o">{</span>

     <span class="n">echo</span> <span class="n">$element</span> <span class="o">.</span> <span class="s">&quot;\n&quot;</span><span class="o">;</span>
 <span class="o">}</span>
</pre></div>
</div>
<p>The code below demonstates the order of Iterator method calls that happened in the <code class="docutils literal"><span class="pre">foreach</span></code> loop above.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
 <span class="k">for</span><span class="p">(</span> <span class="nv">$x</span><span class="o">-&gt;</span><span class="na">rewind</span><span class="p">();</span> <span class="nv">$x</span><span class="o">-&gt;</span><span class="na">valid</span><span class="p">();</span> <span class="nv">$x</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">())</span> <span class="p">{</span>  <span class="c1">// called each time</span>

    <span class="nv">$element</span> <span class="o">=</span>  <span class="nv">$x</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">();</span>
    <span class="k">echo</span> <span class="nv">$element</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>This code shows how to implement an iterator for an array.</p>
<div class="highlight-php" id="arrayiterator"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">arrayIterator</span> <span class="k">implements</span> <span class="nx">Iterator</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nv">$a</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$a</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">valid</span><span class="p">()</span>
    <span class="p">{</span>
       <span class="k">return</span> <span class="nx">valid</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span>
    <span class="p">{</span>
       <span class="nb">next</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
       <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">current</span><span class="p">()</span>
    <span class="p">{</span>
       <span class="k">return</span> <span class="nb">current</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span>
    <span class="p">{</span>
       <span class="nb">reset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">key</span><span class="p">()</span>
    <span class="p">{</span>
       <span class="k">return</span> <span class="nb">key</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And we would use it like so:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
 <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;a&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;bear&quot;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;camel&quot;</span><span class="p">);</span>

 <span class="nv">$iter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">arrayIterator</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$iter</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>

     <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$key</span><span class="s2"> = </span><span class="si">$value\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="iterator-apply-it-callback-array-it">
<h3>iterator_apply( $it, &#8216;callback&#8217;, array($it) )<a class="headerlink" href="#iterator-apply-it-callback-array-it" title="Permalink to this headline">¶</a></h3>
<p>Applies a callback to an objects that implements <code class="docutils literal"><span class="pre">Iterator</span></code>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">print_caps</span><span class="p">(</span><span class="nx">Iterator</span> <span class="nv">$iterator</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$iterator</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">())</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$it</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayIterator</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apples&quot;</span><span class="p">,</span> <span class="s2">&quot;Bananas&quot;</span><span class="p">,</span> <span class="s2">&quot;Cherries&quot;</span><span class="p">));</span>
<span class="nb">iterator_apply</span><span class="p">(</span><span class="nv">$it</span><span class="p">,</span> <span class="s2">&quot;print_caps&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="nv">$it</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="iteratoraggregate-interface">
<h3>IteratorAggregate interface<a class="headerlink" href="#iteratoraggregate-interface" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">IteratorAggregate</span></code> lets you implement your iterator externally.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">MyContainer</span> <span class="kd">implements</span> <span class="n">IteratorAggregate</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="n">function</span> <span class="nf">getIterator</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">new</span> <span class="n">MyExternalIterator</span><span class="o">(</span><span class="n">$this</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MyExternalIterator</span> <span class="kd">implements</span> <span class="n">Iterator</span> <span class="o">{</span>
 <span class="c1">//...snip</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">__construct</span><span class="o">(</span><span class="n">MyContainer</span> <span class="n">$member</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="c1">// Store $member locally for iteration</span>
    <span class="o">}</span>

    <span class="c1">// Implementations for: current(), key(), next(), rewind() and valid() to iterate over data in $member</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">foreach</span></code> implicitly calls <strong>getIterator()</strong></p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
 <span class="nv">$x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SomeClass</span><span class="p">();</span> <span class="c1">// implements IteratorAggregate</span>
 <span class="c1">//...add some elements</span>
 <span class="c1">// iterate using ``foreach``</span>
 <span class="sb">``</span><span class="k">foreach</span><span class="sb">``</span> <span class="p">(</span><span class="nv">$x</span> <span class="k">as</span> <span class="nv">$element</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// calls SomeClass::getIterator()</span>

     <span class="k">echo</span> <span class="nv">$element</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>The Composite Pattern can be implemented using IteratorAggregate. Below class Menu is the composite class. It implements IteratorAggregate to return an external iterator.
The base class class of the containment hierarchy is MenuComponent. It too implements IteratorAggregate and returns an instance of NullIterator.</p>
<p>In the code below The Menu::__toString() method invokes foreach on its components—either submenus or menu items.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">MenuComponent</span> <span class="k">implements</span> <span class="nx">IteratorAggregate</span> <span class="p">{</span>

     <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="nx">MenuComponent</span>  <span class="nv">$m</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::add not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">remove</span><span class="p">(</span><span class="nx">MenuComponent</span> <span class="nv">$m</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::remove not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>

     <span class="k">public</span> <span class="k">function</span> <span class="nf">getName</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::getName not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">getDescription</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::getDescription  not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrice</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::getPrice not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">isVegetarian</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s2">&quot;method MenuComponent::isVegetarian not implemented&quot;</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">getIterator</span><span class="p">()</span>
     <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">NullIterator</span><span class="p">();</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The NullIterator class simply returns <strong>false</strong> when <code class="docutils literal"><span class="pre">valid()</span></code> is called.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">NullIterator</span> <span class="k">implements</span> <span class="nx">Iterator</span> <span class="p">{</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span>
  <span class="p">{</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">current</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">key</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span> <span class="p">{</span>  <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span> <span class="p">{</span>  <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">valid</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>The MenuItem class looks like this</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">MenuItem</span> <span class="k">extends</span> <span class="nx">MenuComponent</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nv">$name</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$description</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$vegetarian</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$price</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$description</span><span class="p">,</span> <span class="nv">$vegetarian</span><span class="p">,</span> <span class="nv">$price</span><span class="p">)</span>
    <span class="p">{</span>
          <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
          <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">description</span> <span class="o">=</span> <span class="nv">$description</span><span class="p">;</span>
          <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vegetarian</span> <span class="o">=</span> <span class="nv">$vegetarian</span><span class="p">;</span>
          <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">price</span> <span class="o">=</span> <span class="nv">$price</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getName</span><span class="p">()</span>
    <span class="p">{</span>
          <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDescription</span><span class="p">()</span>
    <span class="p">{</span>
          <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrice</span><span class="p">()</span>
    <span class="p">{</span>
          <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">price</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">isVegetarian</span><span class="p">()</span>
    <span class="p">{</span>
          <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vegetarian</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__toString</span><span class="p">()</span>
    <span class="p">{</span>
          <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;&lt;br /&gt;  &quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">();</span>

          <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVegetarian</span><span class="p">())</span> <span class="p">{</span>

              <span class="nv">$str</span> <span class="o">.=</span> <span class="s2">&quot;(v)&quot;</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="nv">$str</span> <span class="o">.=</span>  <span class="s2">&quot;, &quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getPrice</span><span class="p">();</span>
          <span class="nv">$str</span> <span class="o">.=</span> <span class="s2">&quot;     -- &quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDescription</span><span class="p">();</span>

          <span class="k">return</span> <span class="nv">$str</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, Menu looks like this</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">Menu</span> <span class="k">extends</span> <span class="nx">MenuComponent</span> <span class="k">implements</span> <span class="nx">IteratorAggregate</span> <span class="p">{</span>

   <span class="k">private</span> <span class="nv">$menuComponents</span><span class="p">;</span>
   <span class="k">private</span> <span class="nv">$name</span><span class="p">;</span>
   <span class="k">private</span> <span class="nv">$description</span><span class="p">;</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$description</span><span class="p">)</span>
   <span class="p">{</span>
       <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">description</span> <span class="o">=</span> <span class="nv">$description</span><span class="p">;</span>
       <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
       <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menuComponents</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="nx">MenuComponent</span> <span class="nv">$menuComponent</span><span class="p">)</span>
   <span class="p">{</span>
       <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menuComponents</span><span class="p">[</span><span class="nb">spl_object_hash</span><span class="p">(</span><span class="nv">$menuComponent</span><span class="p">)]</span> <span class="o">=</span> <span class="nv">$menuComponent</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">remove</span><span class="p">(</span><span class="nx">MenuComponent</span> <span class="nv">$menuComponent</span><span class="p">)</span>
   <span class="p">{</span>
       <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menuComponents</span><span class="p">[</span><span class="nx">\spl_object_hash</span><span class="p">(</span><span class="nv">$menuComponent</span><span class="p">)]);</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">getIterator</span><span class="p">()</span> <span class="c1">// ?</span>
   <span class="p">{</span>
       <span class="k">echo</span> <span class="s2">&quot;Menu::getIterator() just called</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
       <span class="k">return</span> <span class="k">new</span> <span class="nx">MenuIterator</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menuComponents</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span> <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">getDescription</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">;</span> <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">__toString</span><span class="p">()</span>
   <span class="p">{</span>
       <span class="nv">$str</span> <span class="o">=</span><span class="s2">&quot;&lt;br /&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">();</span>
       <span class="nv">$str</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDescription</span><span class="p">();</span>
       <span class="nv">$str</span> <span class="o">.=</span> <span class="s2">&quot;&lt;br /&gt;</span><span class="se">\n</span><span class="s2">---------------------&quot;</span><span class="p">;</span>

       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menuComponents</span> <span class="k">as</span> <span class="nv">$component</span><span class="p">)</span> <span class="p">{</span>

        <span class="nv">$str</span> <span class="o">.=</span> <span class="nv">$component</span><span class="p">;</span> <span class="c1">// calls component&#39;s __toString()</span>
       <span class="p">}</span>
       <span class="nv">$str</span> <span class="o">.=</span> <span class="s2">&quot;&lt;br /&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
       <span class="k">return</span> <span class="nv">$str</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and MenuIterator looks like this</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">MenuIterator</span> <span class="k">implements</span> <span class="nx">Iterator</span> <span class="p">{</span>

  <span class="k">private</span> <span class="nv">$iter</span><span class="p">;</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$m</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayIterator</span><span class="p">(</span><span class="nv">$m</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">current</span><span class="p">()</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">key</span><span class="p">()</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span><span class="o">-&gt;</span><span class="na">rewind</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">valid</span><span class="p">()</span> <span class="p">{</span>  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">iter</span><span class="o">-&gt;</span><span class="na">valid</span><span class="p">();</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, The test code looks like this</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s2">&quot;SplClassLoader.php&quot;</span><span class="p">;</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SplClassLoader</span><span class="p">();</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">();</span>

<span class="k">try</span> <span class="p">{</span>

    <span class="nv">$pancakeHouseMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;PANCAKE HOUSE MENU&quot;</span><span class="p">,</span> <span class="s2">&quot;Breakfast&quot;</span><span class="p">);</span>

    <span class="nv">$dinerMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;DINER MENU&quot;</span><span class="p">,</span> <span class="s2">&quot;Lunch&quot;</span><span class="p">);</span>

    <span class="nv">$cafeMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;CAFE MENU&quot;</span><span class="p">,</span> <span class="s2">&quot;Dinner&quot;</span><span class="p">);</span>

    <span class="nv">$dessertMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;DESSERT MENU&quot;</span><span class="p">,</span> <span class="s2">&quot;Dessert of course!&quot;</span><span class="p">);</span>

    <span class="nv">$coffeeMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;COFFEE MENU&quot;</span><span class="p">,</span> <span class="s2">&quot;Stuff to go with your afternoon coffee&quot;</span><span class="p">);</span>

    <span class="nv">$allMenus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Menu</span><span class="p">(</span><span class="s2">&quot;ALL MENUS&quot;</span><span class="p">,</span> <span class="s2">&quot;All menus combined&quot;</span><span class="p">);</span>

    <span class="nv">$allMenus</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$pancakeHouseMenu</span><span class="p">);</span>
    <span class="nv">$allMenus</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$dinerMenu</span><span class="p">);</span>
    <span class="nv">$allMenus</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$cafeMenu</span><span class="p">);</span>

    <span class="nv">$pancakeItem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;K&amp;B&#39;s Pancake Breakfast&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pancakes with scrambled eggs, and toast&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">2.99</span><span class="p">);</span>

    <span class="nv">$pancakeHouseMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$pancakeItem</span><span class="p">);</span>

    <span class="nv">$pancakeHouseMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Regular Pancake Breakfast&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pancakes with fried eggs, sausage&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">2.99</span><span class="p">));</span>

    <span class="nv">$pancakeHouseMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Blueberry Pancakes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pancakes made with fresh blueberries, and blueberry syrup&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">3.49</span><span class="p">));</span>

    <span class="nv">$pancakeHouseMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Waffles&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Waffles, with your choice of blueberries or strawberries&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">3.59</span><span class="p">));</span>

    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Vegetarian BLT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;(Fakin&#39;) Bacon with lettuce &amp; tomato on whole wheat&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">2.99</span><span class="p">));</span>
    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;BLT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Bacon with lettuce &amp; tomato on whole wheat&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">2.99</span><span class="p">));</span>

    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Soup of the day&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A bowl of the soup of the day, with a side of potato salad&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">3.29</span><span class="p">));</span>

    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Hotdog&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A hot dog, with saurkraut, relish, onions, topped with cheese&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">3.05</span><span class="p">));</span>
    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Steamed Veggies and Brown Rice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Steamed vegetables over brown rice&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">3.99</span><span class="p">));</span>

    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Pasta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Spaghetti with Marinara Sauce, and a slice of sourdough bread&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">3.89</span><span class="p">));</span>

    <span class="nv">$dinerMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$dessertMenu</span><span class="p">);</span>

    <span class="nv">$dessertMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Apple Pie&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Apple pie with a flakey crust, topped with vanilla icecream&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">1.59</span><span class="p">));</span>

    <span class="nv">$dessertMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Cheesecake&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Creamy New York cheesecake, with a chocolate graham crust&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">1.99</span><span class="p">));</span>

    <span class="nv">$dessertMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Sorbet&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A scoop of raspberry and a scoop of lime&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">1.89</span><span class="p">));</span>

    <span class="nv">$cafeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Veggie Burger and Air Fries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Veggie burger on a whole wheat bun, lettuce, tomato, and fries&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">3.99</span><span class="p">));</span>

    <span class="nv">$cafeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Soup of the day&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A cup of the soup of the day, with a side salad&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">3.69</span><span class="p">));</span>

    <span class="nv">$cafeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Burrito&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A large burrito, with whole pinto beans, salsa, guacamole&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">4.29</span><span class="p">));</span>

    <span class="nv">$cafeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$coffeeMenu</span><span class="p">);</span>

    <span class="nv">$coffeeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Coffee Cake&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Crumbly cake topped with cinnamon and walnuts&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
        <span class="mf">1.59</span><span class="p">));</span>

    <span class="nv">$coffeeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Bagel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Flavors include sesame, poppyseed, cinnamon raisin, pumpkin&quot;</span><span class="p">,</span>
            <span class="k">false</span><span class="p">,</span>
            <span class="mf">0.69</span><span class="p">));</span>

    <span class="nv">$coffeeMenu</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MenuItem</span><span class="p">(</span>
            <span class="s2">&quot;Biscotti&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Three almond or hazelnut biscotti cookies&quot;</span><span class="p">,</span>
            <span class="k">true</span><span class="p">,</span>
            <span class="mf">0.89</span><span class="p">));</span>

    <span class="k">echo</span> <span class="nv">$allMenus</span><span class="p">;</span> <span class="c1">// calls Menu::__toString()</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$iter</span> <span class="o">=</span> <span class="nv">$allMenus</span><span class="o">-&gt;</span><span class="na">getIterator</span><span class="p">();</span>
    <span class="nv">$d</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$ex</span><span class="p">)</span> <span class="p">{</span>

   <span class="k">echo</span> <span class="s2">&quot;Exception on line &quot;</span> <span class="o">.</span> <span class="nv">$ex</span><span class="o">-&gt;</span><span class="na">getLine</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; of file &quot;</span> <span class="o">.</span> <span class="nv">$ex</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">()</span> <span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
   <span class="k">echo</span> <span class="nv">$ex</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="generator-functions">
<h3>Generator functions<a class="headerlink" href="#generator-functions" title="Permalink to this headline">¶</a></h3>
<p>A generator is a function that can be iterated by <code class="docutils literal"><span class="pre">foreach</span></code>. It differs from a regular function because it has a <strong>yield</strong> statement instead of <strong>return</strong> statement.
To understand how to create a generator, first imagine class that returns Fibonacci numbers when its is iterated:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">GenerateFibonacci</span> <span class="k">implements</span> <span class="nx">Iterator</span> <span class="p">{</span>

   <span class="k">private</span> <span class="nv">$f1</span><span class="p">;</span>
   <span class="k">private</span> <span class="nv">$f2</span><span class="p">;</span>
   <span class="k">private</span> <span class="nv">$key</span><span class="p">;</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="nb">rewind</span><span class="p">();</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">key</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">valid</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="k">return</span> <span class="k">true</span><span class="p">;</span><span class="c1">// increases without bound.</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">current</span><span class="p">()</span>
   <span class="p">{</span>
     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f1</span> <span class="o">+</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="nv">$temp</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f0</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f1</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">f1</span> <span class="o">=</span> <span class="nv">$temp</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">key</span><span class="o">++</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="k">function</span> <span class="nf">key</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$fibonacci</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FibonacciGenerator</span><span class="p">();</span>

<span class="sb">``</span><span class="k">foreach</span><span class="sb">``</span><span class="p">(</span><span class="nv">$fibonacci</span> <span class="o">=&gt;</span> <span class="nv">$fib_number</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">echo</span> <span class="nv">$fib_number</span> <span class="o">.</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A Fibonacci generator function is much simpler to implement:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">fibonacci</span><span class="p">()</span>
<span class="p">{</span>
  <span class="nv">$f0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$f1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="nv">$true</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$current</span> <span class="o">=</span> <span class="nv">$f1</span> <span class="o">+</span> <span class="nv">$f0</span><span class="p">;</span>
    <span class="nv">$f0</span> <span class="o">=</span> <span class="nv">$f1</span><span class="p">;</span>
    <span class="nv">$f1</span> <span class="o">=</span> <span class="nv">$current</span><span class="p">;</span>

    <span class="k">yield</span> <span class="nv">$current</span><span class="p">;</span>
<span class="p">}</span>

<span class="sb">``</span><span class="k">foreach</span><span class="sb">``</span><span class="p">(</span><span class="nx">fibonacci</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nv">$fib_number</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">echo</span> <span class="nv">$fib_number</span> <span class="o">.</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="seekableiterator-interface">
<h3>SeekableIterator interface<a class="headerlink" href="#seekableiterator-interface" title="Permalink to this headline">¶</a></h3>
<p>SeekableIterator iterface extends Iterator and adds the <code class="docutils literal"><span class="pre">seek($position)</span></code>, to allow repositioning of the iterator (to anywhere within its start position to one past
its end position).</p>
</div>
<div class="section" id="arrayaccess-interface">
<h3>ArrayAccess interface<a class="headerlink" href="#arrayaccess-interface" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">ArrayAccess</span></code> interface allows random access to your collection through the array operator []:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ArrayAccess</span> <span class="o">{</span>
     <span class="cm">/* Methods */</span>
     <span class="kd">abstract</span> <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">offsetExists</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$offset</span> <span class="o">)</span>
     <span class="kd">abstract</span> <span class="kd">public</span> <span class="n">mixed</span> <span class="nf">offsetGet</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$offset</span> <span class="o">)</span>
     <span class="kd">abstract</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">offsetSet</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$offset</span> <span class="o">,</span> <span class="n">mixed</span> <span class="n">$value</span> <span class="o">)</span>
     <span class="kd">abstract</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">offsetUnset</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$offset</span> <span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Example of Book class that implements ArrayAccess</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Book</span> <span class="k">implements</span> <span class="nx">ArrayAccess</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$title</span><span class="p">;</span>

    <span class="k">public</span> <span class="nv">$author</span><span class="p">;</span>

    <span class="k">public</span> <span class="nv">$isbn</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">offsetExists</span><span class="p">(</span> <span class="nv">$offset</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$offset</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">offsetSet</span><span class="p">(</span> <span class="nv">$offset</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$offset</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">offsetGet</span><span class="p">(</span> <span class="nv">$offset</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$offset</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">offsetUnset</span><span class="p">(</span> <span class="nv">$offset</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nb">unset</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$offset</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="sd">/*** end of class ***/</span>

<span class="nv">$book</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">book</span><span class="p">;</span>

<span class="nv">$book</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">=</span> <span class="s1">&#39;Pro PHP&#39;</span><span class="p">;</span>
<span class="nv">$book</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Kevin McArthur&#39;</span><span class="p">;</span>
<span class="nv">$book</span><span class="p">[</span><span class="s1">&#39;isbn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1590598199</span><span class="p">;</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$book</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;book[</span><span class="si">$key</span><span class="s2">] = </span><span class="si">$value</span><span class="s2">&lt;/p&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note: In PHP any class can be used in a <code class="docutils literal"><span class="pre">foreach</span></code> loop. It does not have to implement the Iterator interface(or one that extends it). By default the properties
of the object are returned by default.</p>
</div>
<div class="section" id="countable-interface">
<h3>Countable interface<a class="headerlink" href="#countable-interface" title="Permalink to this headline">¶</a></h3>
<p>Implementing the <code class="docutils literal"><span class="pre">Countable</span></code> interface and providing a <code class="docutils literal"><span class="pre">count()</span></code> method allows your objects to be passed to <code class="docutils literal"><span class="pre">\count($collection);</span></code>.</p>
</div>
<div class="section" id="arrayobject-class">
<h3>ArrayObject class<a class="headerlink" href="#arrayobject-class" title="Permalink to this headline">¶</a></h3>
<p>ArrayObject implements IteratorAggregate , ArrayAccess , Serializable , and Countable. It also implements a number of its own member functions:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ArrayObject</span> <span class="kd">implements</span> <span class="n">IteratorAggregate</span> <span class="o">,</span> <span class="n">ArrayAccess</span> <span class="o">,</span> <span class="n">Serializable</span> <span class="o">,</span> <span class="n">Countable</span> <span class="o">{</span>

    <span class="cm">/* Constants */</span>
    <span class="kd">const</span> <span class="n">integer</span> <span class="n">STD_PROP_LIST</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">;</span>
    <span class="kd">const</span> <span class="n">integer</span> <span class="n">ARRAY_AS_PROPS</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">;</span>
    <span class="cm">/* Methods */</span>
    <span class="kd">public</span> <span class="nf">__construct</span> <span class="o">([</span> <span class="n">mixed</span> <span class="n">$input</span> <span class="o">=</span> <span class="o">[]</span> <span class="o">[,</span> <span class="kt">int</span> <span class="n">$flags</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">[,</span> <span class="n">string</span> <span class="n">$iterator_class</span> <span class="o">=</span> <span class="s">&quot;ArrayIterator&quot;</span> <span class="o">]]]</span> <span class="o">)</span>

    <span class="c1">// ArrayAccess methods</span>
    <span class="kd">public</span> <span class="n">bool</span> <span class="nf">offsetExists</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$index</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="n">mixed</span> <span class="nf">offsetGet</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$index</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">offsetSet</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$index</span> <span class="o">,</span> <span class="n">mixed</span> <span class="n">$newval</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">offsetUnset</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$index</span> <span class="o">)</span>

    <span class="c1">// IteratorAggregate methods</span>
    <span class="kd">public</span> <span class="n">ArrayIterator</span> <span class="nf">getIterator</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>

    <span class="c1">// Serializable methods</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">unserialize</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$serialized</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="n">string</span> <span class="nf">serialize</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>

    <span class="c1">// Countable method</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">count</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>

    <span class="c1">// other public methods</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">append</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$value</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">asort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="n">array</span> <span class="nf">exchangeArray</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$input</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="n">array</span> <span class="nf">getArrayCopy</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getFlags</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="n">string</span> <span class="nf">getIteratorClass</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ksort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">natcasesort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">natsort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">uasort</span> <span class="o">(</span> <span class="n">callable</span> <span class="n">$cmp_function</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">uksort</span> <span class="o">(</span> <span class="n">callable</span> <span class="n">$cmp_function</span> <span class="o">)</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFlags</span> <span class="o">(</span> <span class="kt">int</span> <span class="n">$flags</span> <span class="o">)</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setIteratorClass</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$iterator_class</span> <span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>ArrayObject::getIterator() will return an ArrayIterator. If you extend ArrayObject, you can return your own iterator type, but it must derive from ArrayIterator.</p>
<div class="section" id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h4>
<p>ArrayObject lets you treat an object like an array: it allows you to access its access properties using array syntax, and it allows iterating them via foreach. When you
create an ArrayObject from an associative array, the objects properties take on the name of the keys of the array.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nx">data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;name&quot;</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;john@domain.com&quot;</span>
<span class="p">);</span>

<span class="nv">$arrayObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayObject</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="c1">// access the object properties using an array notation</span>
<span class="k">echo</span> <span class="s2">&quot;Name is &quot;</span> <span class="o">.</span> <span class="nv">$arrayObj</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;. Email is &quot;</span> <span class="o">.</span> <span class="nv">$arrayObj</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">];</span>
</pre></div>
</div>
<p>You can also pass an object to the constructor, and it will create properties identical to the names of the properties of the object—provided they are public.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">EmailUser</span> <span class="p">{</span>
     <span class="k">public</span> <span class="nv">$name</span><span class="p">;</span>
     <span class="k">public</span> <span class="nv">$email</span><span class="p">;</span>
     <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$email</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">email</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">EmailUser</span><span class="p">(</span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;john@domain.com&quot;</span><span class="p">);</span>

<span class="c1">// create an instance of the ArrayObject class</span>
<span class="nv">$arrayObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayObject</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>

<span class="c1">// access the object properties using an array notation</span>
<span class="c1">// displays the following: Full name: John Doe Email: john@domain.com</span>
<span class="k">echo</span> <span class="s2">&quot;Full name: &quot;</span> <span class="o">.</span> <span class="nv">$arrayObj</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; Email: &quot;</span> <span class="o">.</span> <span class="nv">$arrayObj</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span>

<span class="c1">// count the number of properties in the object</span>
<span class="k">echo</span> <span class="s2">&quot;total properties is &quot;</span> <span class="o">.</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$arrayObj</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">new</span> <span class="pre">ArrayObject($data)</span></code> is equivalent to <code class="docutils literal"><span class="pre">new</span> <span class="pre">ArrayObject($data,</span> <span class="pre">ArrayObject::STD_PROP_LIST)</span></code>. <code class="docutils literal"><span class="pre">STD_PROP_LIST</span></code> is the default behavior.
A good way to understand the usefulness ArrayObject is to compare it to the SimpleXML extension. SimpleXML objects are a type of ArrayObject in that a SimpleXML object
also acts like an array which makes it efficient to use because you can just <strong>foreach</strong> or access one of the elements within the list. You don not
have to grab an array from the object and then iterate over and do something else with it if you want the tag name or an attribute.</p>
<p>When the constant <code class="docutils literal"><span class="pre">ArrayObject::ARRAY_AS_PROPS</span></code> is passed to the constructor or to the <code class="docutils literal"><span class="pre">setFlags()</span></code> method, it’s possible to handle the properties by means of an
object syntax. For example</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$data = array(</span>
<span class="x">    ‘name’  =&gt; ‘John Doe’,</span>
<span class="x">    ‘email’ =&gt; ‘john@domain.com’</span>
<span class="x">);</span>

<span class="x">// create an instance of the ArrayObject class</span>
<span class="x">$arrayObj = new ArrayObject($data, ArrayObject::ARRAY_AS_PROPS);</span>

<span class="x">// access the object properties using an object notation</span>
<span class="x">// displays the following: Full name: John Doe Email: john@domain.com</span>
<span class="x">echo ‘Full name: ‘ . $arrayObj-&gt;name . ‘ Email: ‘ . $arrayObj-&gt;email;</span>

<span class="x">// count the number of properties in the object</span>
<span class="x">echo ‘Number of properties assigned to the object: ‘ . count($arrayObj);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arrayiterator-class">
<h3>ArrayIterator class<a class="headerlink" href="#arrayiterator-class" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">ArrayIterator</span> <span class="kd">implements</span> <span class="n">ArrayAccess</span> <span class="o">,</span> <span class="n">SeekableIterator</span> <span class="o">,</span> <span class="n">Countable</span> <span class="o">,</span> <span class="n">Serializable</span> <span class="o">{</span><span class="c1">//...  }</span>
</pre></div>
</div>
<p>This iterator allows you to both unset and modify values and keys while iterating over arrays and objects. To explictily create an ArrayIterator, pass a PHP array() to the constructor.
Explicitly calling <code class="docutils literal"><span class="pre">ArrayObject::getIterator()</span></code> also returns an ArrayIterator.  ArrayIterator instances are created implicitly when <strong>``foreach``</strong> encounters an ArrayObject.</p>
<p>ArrayIterator wraps these PHP functions for built–in PHP arrays: ksort, natcasesort, natsort, uasort, and uksort.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ArrayIterator</span> <span class="kd">implements</span> <span class="n">ArrayAccess</span> <span class="o">,</span> <span class="n">SeekableIterator</span> <span class="o">,</span> <span class="n">Countable</span> <span class="o">,</span> <span class="n">Serializable</span> <span class="o">{</span><span class="c1">//...}</span>
    <span class="c1">//. . . snip</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">asort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">ksort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">natcasesort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">natsort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">uasort</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$cmp_function</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">function</span> <span class="nf">uksort</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$cmp_function</span> <span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You instantiate ArrayIterator either explicitly by passing a built-in array or implicitly by invoking <code class="docutils literal"><span class="pre">foreach</span></code> on an ArrayObject, which invokes <code class="docutils literal"><span class="pre">ArrayObject::getIterator()</span></code>, which
returns an ArrayIterator.</p>
</div>
<div class="section" id="iterating-recursive-structures">
<h3>Iterating Recursive Structures<a class="headerlink" href="#iterating-recursive-structures" title="Permalink to this headline">¶</a></h3>
<p>How do we iterate a multidimensional array, or any array with a nested subarray? And more generally how do we create iterators for composite objects that model containment hierachies?
For example, if we call foreach on this array</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
        <span class="mi">1</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="mi">3</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="p">);</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$key</span><span class="s2"> =&gt; </span><span class="si">$value</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>we will get an error when the first subarrays is encountered.</p>
<div class="section" id="recursiveiterator">
<h4>RecursiveIterator<a class="headerlink" href="#recursiveiterator" title="Permalink to this headline">¶</a></h4>
<p>The first interface used to solve the problem of iterating any array that has at least one subarray is RecursiveIterator.
It extends Iterator and adds the <code class="docutils literal"><span class="pre">hasChildren()</span></code> and <code class="docutils literal"><span class="pre">getChildren()</span></code>. <code class="docutils literal"><span class="pre">hasChildren</span></code> returns <strong>true</strong> if the current element can be iterated, and <code class="docutils literal"><span class="pre">getChildren()</span></code>
returns that iterator <code class="docutils literal"><span class="pre">getChildren()</span></code>, which must at least be of type RecursiveIterator.</p>
<p>Here is an sample implementation of <code class="docutils literal"><span class="pre">RecursiveIterator</span></code>. It extends <code class="docutils literal"><span class="pre">arrayIterator</span></code> implemented <a class="reference internal" href="#arrayiterator"><span>previously</span></a>.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
 <span class="k">class</span> <span class="nc">MyRecursiveIterator</span> <span class="k">extends</span> <span class="nx">arrayIterator</span> <span class="k">implements</span> <span class="nx">RecursiveIterator</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="k">array</span> <span class="o">&amp;</span><span class="nv">$a</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Returns true if an iterator can be created/returned for the current entry.</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">hasChildren</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nb">current</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">// Returns a MyRecursiveIterator for the current entry.</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getChildren</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$subarray</span> <span class="o">=</span> <span class="nb">current</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MyRecursiveIterator</span><span class="p">(</span><span class="nv">$subarray</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To use <code class="docutils literal"><span class="pre">MyRecursiveIterator</span></code> you write a recursive function:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">recursive_iterate</span><span class="p">(</span><span class="nx">MyRecursiveIterator</span> <span class="nv">$it</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="nv">$it</span><span class="o">-&gt;</span><span class="na">valid</span><span class="p">())</span> <span class="p">{</span>

    <span class="c1">// if there is a subarray, we call getChildren and recurse...</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$it</span><span class="o">-&gt;</span><span class="na">hasChildren</span><span class="p">())</span> <span class="p">{</span>

       <span class="k">echo</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">()</span><span class="o">.</span> <span class="s2">&quot; =&gt; (&quot;</span> <span class="p">;</span>

       <span class="nx">recursive_iterate</span><span class="p">(</span><span class="nv">$it</span><span class="o">-&gt;</span><span class="na">getChildren</span><span class="p">());</span>

       <span class="k">echo</span> <span class="s2">&quot;), &quot;</span><span class="p">;</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

      <span class="c1">// otherwise, print the currentkey and value.</span>
      <span class="k">echo</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; =&gt; &quot;</span> <span class="o">.</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, we create an array with some subarrays and use our new code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$a2</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">2</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
            <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
            <span class="mi">5</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>

<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=============</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

<span class="nv">$mri</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyRecursiveIterator</span><span class="p">(</span><span class="nv">$a2</span><span class="p">);</span>

<span class="nx">recursive_iterate</span><span class="p">(</span><span class="nv">$mri</span><span class="p">);</span>
</pre></div>
</div>
<p>This outputs:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">0</span> <span class="o">=</span>&gt; 0, <span class="nv">1</span> <span class="o">=</span>&gt; 1, <span class="nv">2</span> <span class="o">=</span>&gt; <span class="o">(</span><span class="nv">0</span> <span class="o">=</span>&gt; 10, <span class="nv">1</span> <span class="o">=</span>&gt; 20, <span class="nv">2</span> <span class="o">=</span>&gt; 30, <span class="o">)</span>, <span class="nv">3</span> <span class="o">=</span>&gt; 3, <span class="nv">4</span> <span class="o">=</span>&gt; 4, <span class="nv">5</span> <span class="o">=</span>&gt; <span class="o">(</span><span class="nv">0</span> <span class="o">=</span>&gt; 1, <span class="nv">1</span> <span class="o">=</span>&gt; 2, <span class="nv">2</span> <span class="o">=</span>&gt; 3, <span class="o">)</span>,
</pre></div>
</div>
</div>
<div class="section" id="recursiveiteratoriterator">
<h4>RecursiveIteratorIterator<a class="headerlink" href="#recursiveiteratoriterator" title="Permalink to this headline">¶</a></h4>
<p>Fortunately, PHP already provides support for recursive iteration of multi-dimensional arrays. We do not have to roll our own. You can iterate any array with subarrays
in a <code class="docutils literal"><span class="pre">foreach</span></code> loop using <code class="docutils literal"><span class="pre">RecursiveIteratorIterator</span></code> whose constructor, takes a <code class="docutils literal"><span class="pre">RecursiveIterator</span></code> instance. Example:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$it</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RecursiveIteratorIterator</span><span class="p">(</span><span class="k">new</span> <span class="nx">MyRecusvieIterator</span><span class="p">(</span><span class="nv">$a2</span><span class="p">))</span> <span class="p">{</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$it</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span>

      <span class="c1">// print the value.</span>
      <span class="k">echo</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we change <code class="docutils literal"><span class="pre">foreach</span></code> to return both the current key and value, like so</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$it</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RecursiveIteratorIterator</span><span class="p">(</span><span class="k">new</span> <span class="nx">MyRecusvieIterator</span><span class="p">(</span><span class="nv">$a2</span><span class="p">))</span> <span class="p">{</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$it</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span>

      <span class="c1">// print the curren tkey and value.</span>
     <span class="k">echo</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">key</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; =&gt; &quot;</span> <span class="o">.</span> <span class="nv">$it</span><span class="o">-&gt;</span><span class="na">current</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>the output is</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">0</span> <span class="o">=</span>&gt; 0, <span class="nv">1</span> <span class="o">=</span>&gt; 1, <span class="nv">0</span> <span class="o">=</span>&gt; 10, <span class="nv">1</span> <span class="o">=</span>&gt; 20, <span class="nv">2</span> <span class="o">=</span>&gt; 30, <span class="nv">3</span> <span class="o">=</span>&gt; 3, <span class="nv">4</span> <span class="o">=</span>&gt; 4, <span class="nv">0</span> <span class="o">=</span>&gt; 1, <span class="nv">1</span> <span class="o">=</span>&gt; 2, <span class="nv">2</span> <span class="o">=</span>&gt; 3,
</pre></div>
</div>
<p>which does not includes key values for the subarrays: the keys 2 and 5 in the outer array are never returned.</p>
<p>....finish these idea by using this bookmark:</p>
<p>Incorporate this info:
as well as</p>
<ul class="simple">
<li><a class="reference external" href="http://www.giorgiosironi.com/2010/02/practical-php-patterns-iterator.html">http://www.giorgiosironi.com/2010/02/practical-php-patterns-iterator.html</a>   Very good overview</li>
<li><a class="reference external" href="http://stackoverflow.com/questions/12077177/how-does-recursiveiteratoriterator-work-in-php">http://stackoverflow.com/questions/12077177/how-does-recursiveiteratoriterator-work-in-php</a> The examples here are really educational. They illustrares the differences between the iterator types.</li>
<li><a class="reference external" href="http://www.sitepoint.com/using-spl-iterators-1/">http://www.sitepoint.com/using-spl-iterators-1/</a>   Gentle Introduction</li>
<li><a class="reference external" href="https://learnable.com/books/php-master-write-cutting-edge-code/online/apbs03.html">https://learnable.com/books/php-master-write-cutting-edge-code/online/apbs03.html</a></li>
<li><a class="reference external" href="http://coder-zone.blogspot.com/2013/05/custom-recursiveiterator.html">http://coder-zone.blogspot.com/2013/05/custom-recursiveiterator.html</a></li>
</ul>
<p>and  this <a class="reference external" href="http://students.kiv.zcu.cz/doc/php5/~helly/php/ext/spl/main.html">excellent discussion</a> on iterators in PHP, which explains the use of RecursiveIteratorIterator::SELF_FIRST.</p>
<p>Based on first link above, RecursiveIteratorIterator adapts a RecursiveIterator, so that it can be used like a Iterator and used in <code class="docutils literal"><span class="pre">foreach</span></code> to recurse an entire tree structure. Technically, RecursiveIterator is an OuterIterface, but the intent
is still the same: allow Iterator–like use in <code class="docutils literal"><span class="pre">foreach</span></code>.</p>
</div>
<div class="section" id="recursivearrayiterator">
<h4>RecursiveArrayIterator<a class="headerlink" href="#recursivearrayiterator" title="Permalink to this headline">¶</a></h4>
<p>RecursiveArrayIterator adds two methods to ArrayIterator: <code class="docutils literal"><span class="pre">getChildren()</span></code> and <code class="docutils literal"><span class="pre">hasChildren()</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">RecursiveArrayIterator</span> <span class="kd">extends</span> <span class="n">ArrayIterator</span> <span class="kd">implements</span> <span class="n">RecursiveIterator</span> <span class="o">{</span>

    <span class="cm">/* Methods */</span>
    <span class="cm">/* Returns an iterator for the current entry if it is an array or object */</span>
    <span class="kd">public</span> <span class="n">RecursiveArrayIterator</span> <span class="nf">getChildren</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>

    <span class="cm">/* Returns true if the current entry is an array or object */</span>
    <span class="kd">public</span> <span class="n">bool</span> <span class="nf">hasChildren</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>

    <span class="cm">/* Inherits */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">append</span> <span class="o">(</span> <span class="n">mixed</span> <span class="n">$value</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">asort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">__construct</span> <span class="o">([</span> <span class="n">mixed</span> <span class="n">$array</span> <span class="o">=</span> <span class="n">array</span><span class="o">();</span> <span class="o">[,</span> <span class="kt">int</span> <span class="n">$flags</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">]]</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">count</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">mixed</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">current</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">array</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">getArrayCopy</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">getFlags</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">mixed</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">key</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">ksort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">natcasesort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">natsort</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">next</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">offsetExists</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$index</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">mixed</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">offsetGet</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$index</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">offsetSet</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$index</span> <span class="o">,</span> <span class="n">string</span> <span class="n">$newval</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">offsetUnset</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$index</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">rewind</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">seek</span> <span class="o">(</span> <span class="kt">int</span> <span class="n">$position</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">string</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">serialize</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">setFlags</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$flags</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">uasort</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$cmp_function</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">uksort</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$cmp_function</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">string</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">unserialize</span> <span class="o">(</span> <span class="n">string</span> <span class="n">$serialized</span> <span class="o">);</span>
    <span class="kd">public</span> <span class="n">bool</span> <span class="n">ArrayIterator</span><span class="o">::</span><span class="n">valid</span> <span class="o">(</span> <span class="kt">void</span> <span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This iterator allows you to unset and modify values and keys while iterating over Arrays and Objects in the same way as the ArrayIterator. Additionally it is possible to iterate over the current iterator entry.
The use of ArrayIterator is straight forward, but limited to single dimensional arrays. Sometimes you’ll have a multidimensional array and you’ll want to iterate through the nested arrays recursively. In this case you can use RecursiveArrayIterator
See this <a class="reference external" href="http://www.sitepoint.com/using-spl-iterators-1/">article</a> for next topic.</p>
<p>What did the verbage above mean?</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">PHP SPL Iterators 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Kurt Krueckeberg.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>